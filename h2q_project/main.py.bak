import logging
from h2q_project.memory_monitor import MemoryMonitor
import threading
import time

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

def main():
    logger = logging.getLogger(__name__)
    logger.info("Starting the main application...")

    # Start the memory monitor in a separate thread
    memory_monitor = MemoryMonitor(interval=60)
    memory_thread = threading.Thread(target=memory_monitor.start)
    memory_thread.daemon = True  # Allow the main thread to exit even if the monitor is running
    memory_thread.start()

    # Simulate some main application work
    try:
        while True:
            logger.info("Doing some work...")
            time.sleep(5)
    except KeyboardInterrupt:
        logger.info("Shutting down the application.")

if __name__ == "__main__":
    main()