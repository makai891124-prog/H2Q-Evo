{
  "timestamp": 1769069961.27103,
  "response": "[\n  {\n    \"file_path\": \"h2q_project/pruning/pruner.py\",\n    \"content\": \"import torch\\nimport torch.nn as nn\\nimport numpy as np\\n\\nclass Pruner:\\n    def __init__(self, model, prune_percent=0.5):\\n        self.model = model\\n        self.prune_percent = prune_percent\\n\\n    def prune_weights(self):\\n        \\\"\\\"\\\"Prunes the weights of the model based on magnitude.\\\"\\\"\\\"\\n        parameters_to_prune = []\\n        for name, module in self.model.named_modules():\\n            if isinstance(module, (nn.Linear, nn.Conv2d)):\\n                parameters_to_prune.append((module, 'weight'))\\n\\n        for module, name in parameters_to_prune:\\n            self._prune_layer_weights(module, name)\\n\\n    def _prune_layer_weights(self, module, name):\\n        \\\"\\\"\\\"Prunes the weights of a single layer.\\\"\\\"\\\"\\n        weight = module.weight.data.cpu().numpy()\\n        abs_weight = np.abs(weight)\\n        threshold = np.percentile(abs_weight, self.prune_percent * 100)\\n        mask = abs_weight > threshold\\n        mask = torch.from_numpy(mask).to(module.weight.device)\\n\\n        # Apply mask to the weight\\n        module.weight.data[mask == False] = 0\\n\\n\\n\\nif __name__ == '__main__':\\n    # Example Usage (replace with your actual model)\\n    class SimpleModel(nn.Module):\\n        def __init__(self):\\n            super(SimpleModel, self).__init__()\\n            self.fc1 = nn.Linear(10, 20)\\n            self.relu = nn.ReLU()\\n            self.fc2 = nn.Linear(20, 5)\\n\\n        def forward(self, x):\\n            x = self.fc1(x)\\n            x = self.relu(x)\\n            x = self.fc2(x)\\n            return x\\n\\n    model = SimpleModel()\\n\\n    # Example: Prune 50% of the weights\\n    pruner = Pruner(model, prune_percent=0.5)\\n    pruner.prune_weights()\\n\\n    # Verify that some weights are now zero.\\n    for name, param in model.named_parameters():\\n        if 'weight' in name:\\n            print(f\\\"{name}: Number of non-zero elements = {torch.count_nonzero(param.data)}\\\")\\n\"\n  }\n]",
  "model": "gemini-2.0-flash"
}