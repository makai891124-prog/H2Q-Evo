{
  "timestamp": 1769066250.2317572,
  "response": "```json\n{\n  \"file_path\": \"utils/data_processing.py\",\n  \"content\": \"import numpy as np\\nimport pandas as pd\\n\\n\\ndef calculate_descriptive_stats(data: pd.DataFrame, columns: list) -> dict:\\n    \\\"\\\"\\\"Calculates descriptive statistics for specified columns in a DataFrame.\\n\\n    Args:\\n        data: pandas DataFrame containing the data.\\n        columns: List of column names for which to calculate statistics.\\n\\n    Returns:\\n        A dictionary containing descriptive statistics for each specified column.\\n        Returns an empty dictionary if input data is invalid.\\n    \\\"\\\"\\\"\\n    if not isinstance(data, pd.DataFrame) or not isinstance(columns, list):\\n        print(\\\"Error: Invalid input data type. Expecting pandas DataFrame and a list of column names.\\\")\\n        return {}\\n\\n    stats = {}\\n    for col in columns:\\n        if col in data.columns:\\n            stats[col] = {\\n                \\\"mean\\\": data[col].mean(),\\n                \\\"median\\\": data[col].median(),\\n                \\\"std\\\": data[col].std(),\\n                \\\"min\\\": data[col].min(),\\n                \\\"max\\\": data[col].max(),\\n            }\\n        else:\\n            print(f\\\"Warning: Column '{col}' not found in DataFrame.\\\")\\n    return stats\\n\\n\\ndef handle_missing_values(data: pd.DataFrame, method: str = \\\"drop\\\") -> pd.DataFrame:\\n    \\\"\\\"\\\"Handles missing values in a DataFrame.\\n\\n    Args:\\n        data: pandas DataFrame containing the data.\\n        method: Method for handling missing values. Options: 'drop' (default), 'mean', 'median', 'ffill', 'bfill'.\\n\\n    Returns:\\n        A DataFrame with missing values handled according to the specified method.\\n        Returns the original DataFrame if an invalid method is specified.\\n    \\\"\\\"\\\"\\n    if not isinstance(data, pd.DataFrame):\\n        print(\\\"Error: Invalid input data type. Expecting pandas DataFrame.\\\")\\n        return data # Return original DataFrame for invalid input\\n\\n    if method == \\\"drop\\\":\\n        cleaned_data = data.dropna()\\n    elif method == \\\"mean\\\":\\n        cleaned_data = data.fillna(data.mean())\\n    elif method == \\\"median\\\":\\n        cleaned_data = data.fillna(data.median())\\n    elif method == \\\"ffill\\\":\\n        cleaned_data = data.fillna(method=\\\"ffill\\\")\\n    elif method == \\\"bfill\\\":\\n        cleaned_data = data.fillna(method=\\\"bfill\\\")\\n    else:\\n        print(f\\\"Warning: Invalid method '{method}'. Returning original DataFrame.\\\")\\n        return data # Return original DataFrame for invalid method\\n\\n    return cleaned_data\\n\\n\\n\\ndef normalize_data(data: pd.DataFrame, columns: list, method: str = \\\"minmax\\\") -> pd.DataFrame:\\n    \\\"\\\"\\\"Normalizes specified columns in a DataFrame.\\n\\n    Args:\\n        data: pandas DataFrame containing the data.\\n        columns: List of column names to normalize.\\n        method: Normalization method. Options: 'minmax' (default), 'zscore'.\\n\\n    Returns:\\n        A DataFrame with specified columns normalized.\\n        Returns the original DataFrame if input data is invalid or no columns are specified.\\n    \\\"\\\"\\\"\\n    if not isinstance(data, pd.DataFrame) or not isinstance(columns, list):\\n        print(\\\"Error: Invalid input data type. Expecting pandas DataFrame and a list of column names.\\\")\\n        return data # Return original DataFrame for invalid input\\n\\n    if not columns:\\n        print(\\\"Warning: No columns specified for normalization. Returning original DataFrame.\\\")\\n        return data # Return original DataFrame if no columns specified\\n\\n    normalized_data = data.copy()\\n    for col in columns:\\n        if col in normalized_data.columns:\\n            if method == \\\"minmax\\\":\\n                min_val = normalized_data[col].min()\\n                max_val = normalized_data[col].max()\\n                if min_val == max_val:\\n                    print(f\\\"Warning: Column '{col}' has constant value, skipping normalization.\\\")\\n                else:\\n                    normalized_data[col] = (normalized_data[col] - min_val) / (max_val - min_val)\\n            elif method == \\\"zscore\\\":\\n                mean_val = normalized_data[col].mean()\\n                std_val = normalized_data[col].std()\\n                if std_val == 0:\\n                    print(f\\\"Warning: Column '{col}' has zero standard deviation, skipping normalization.\\\")\\n                else:\\n                    normalized_data[col] = (normalized_data[col] - mean_val) / std_val\\n            else:\\n                print(f\\\"Warning: Invalid normalization method '{method}'. Skipping column '{col}'.\\\")\\n        else:\\n            print(f\\\"Warning: Column '{col}' not found in DataFrame. Skipping.\\\")\\n\\n    return normalized_data\\n\"\n}\n```",
  "model": "gemini-2.0-flash"
}