{
  "timestamp": 1769070035.1875908,
  "response": "[\n  {\n    \"file_path\": \"h2q_project/code_generator.py\",\n    \"content\": \"import ast\\nimport inspect\\nimport textwrap\\n\\nclass CodeGenerator:\\n    def __init__(self, indent_size=4):\\n        self.indent_size = indent_size\\n\\n    def generate_function(self, function_name, args, body_lines, return_type=None):\\n        \\\"\\\"\\\"Generates a Python function as a string.\\n\\n        Args:\\n            function_name (str): The name of the function.\\n            args (list): A list of tuples, where each tuple contains the argument name and its type (e.g., [('arg1', 'int'), ('arg2', 'str')]).\\n            body_lines (list): A list of strings representing the lines of code in the function body.\\n            return_type (str, optional): The return type of the function. Defaults to None.\\n\\n        Returns:\\n            str: The generated Python function as a string.\\n        \\\"\\\"\\\"\\n        arg_string = ', '.join([f'{arg_name}: {arg_type}' for arg_name, arg_type in args])\\n        return_type_hint = f' -> {return_type}' if return_type else ''\\n        function_header = f'def {function_name}({arg_string}){return_type_hint}:'\\n        indented_body = [(' ' * self.indent_size) + line for line in body_lines]\\n        function_body = '\\\\n'.join(indented_body)\\n        function_string = f'{function_header}\\\\n{function_body}'\\n        return function_string\\n\\n    def generate_class(self, class_name, attributes, methods):\\n        \\\"\\\"\\\"Generates a Python class as a string.\\n\\n        Args:\\n            class_name (str): The name of the class.\\n            attributes (list): A list of tuples, where each tuple contains the attribute name and its type (e.g., [('attr1', 'int'), ('attr2', 'str')]).\\n            methods (list): A list of method strings, already formatted.\\n\\n        Returns:\\n            str: The generated Python class as a string.\\n        \\\"\\\"\\\"\\n        class_header = f'class {class_name}:'\\n        attribute_lines = [f'    self.{attr_name}: {attr_type} = None' for attr_name, attr_type in attributes]\\n        method_strings = ['    ' + method.replace('\\\\n', '\\\\n    ') for method in methods]\\n\\n        class_body_parts = attribute_lines + method_strings\\n        if not class_body_parts:\\n            class_body_parts = ['    pass']  # Add a pass statement if the class is empty\\n\\n        class_body = '\\\\n'.join(class_body_parts)\\n        class_string = f'{class_header}\\\\n{class_body}'\\n        return class_string\\n\\n    def generate_code_block(self, code_lines):\\n        \\\"\\\"\\\"Generates a simple code block with indentation.\\n\\n        Args:\\n            code_lines (list): A list of strings representing the lines of code.\\n\\n        Returns:\\n            str: The generated code block as a string.\\n        \\\"\\\"\\\"\\n        indented_code = [(' ' * self.indent_size) + line for line in code_lines]\\n        code_block = '\\\\n'.join(indented_code)\\n        return code_block\\n\\n    def validate_code(self, code_string):\\n        \\\"\\\"\\\"Validates the generated code by attempting to parse it into an AST.\\n\\n        Args:\\n            code_string (str): The code to validate.\\n\\n        Returns:\\n            bool: True if the code is valid, False otherwise.\\n        \\\"\\\"\\\"\\n        try:\\n            ast.parse(code_string)\\n            return True\\n        except SyntaxError:\\n            return False\\n\\n    def generate_valid_code(self, generation_function, *args, max_attempts=5):\\n        \\\"\\\"\\\"Attempts to generate valid code using the given generation function.\\n\\n        Args:\\n            generation_function (callable): The code generation function to use.\\n            *args: Arguments to pass to the generation function.\\n            max_attempts (int): The maximum number of attempts to generate valid code.\\n\\n        Returns:\\n            str: The generated code string, or None if no valid code could be generated.\\n        \\\"\\\"\\\"\\n        for _ in range(max_attempts):\\n            code_string = generation_function(*args)\\n            if self.validate_code(code_string):\\n                return code_string\\n        return None\\n\\n    def get_source_code(self, obj):\\n        \\\"\\\"\\\"Retrieves the source code of a Python object (function or class).\\n\\n        Args:\\n            obj (object): The Python object.\\n\\n        Returns:\\n            str: The source code of the object, or None if it cannot be retrieved.\\n        \\\"\\\"\\\"\\n        try:\\n            source_code = inspect.getsource(obj)\\n            return textwrap.dedent(source_code)\\n        except OSError:\\n            return None\"\n  }\n]",
  "model": "gemini-2.0-flash"
}