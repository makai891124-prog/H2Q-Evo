{
  "timestamp": 1769070862.041944,
  "response": "[\n  {\n    \"file_path\": \"h2q_project/quaternion_ops.py\",\n    \"content\": \"import numpy as np\\n\\n\\ndef quaternion_conjugate(quaternion):\\n    \\\"\\\"\\\"计算四元数的共轭.\\\"\\\"\\\"\\n    w, x, y, z = quaternion\\n    return np.array([w, -x, -y, -z])\\n\\n\\ndef quaternion_multiply(quaternion1, quaternion0):\\n    \\\"\\\"\\\"按照 Hamilton 规则计算两个四元数的乘积.\\n    见：https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Quaternion_multiplication\\n    \\\"\\\"\\\"\\n    w0, x0, y0, z0 = quaternion0\\n    w1, x1, y1, z1 = quaternion1\\n    return np.array([\\n        w1 * w0 - x1 * x0 - y1 * y0 - z1 * z0,\\n        w1 * x0 + x1 * w0 - y1 * z0 + z1 * y0,\\n        w1 * y0 + x1 * z0 + y1 * w0 - z1 * x0,\\n        w1 * z0 - x1 * y0 + y1 * x0 + z1 * w0\\n    ])\\n\\n\\ndef quaternion_to_rotation_matrix(quaternion):\\n    \\\"\\\"\\\"将四元数转换为旋转矩阵.\\n    见：https://en.wikipedia.org/wiki/Rotation_matrix#Quaternion\\n    \\\"\\\"\\\"\\n    w, x, y, z = quaternion\\n\\n    # 计算归一化四元数 (如果它没有被归一化).\\n    norm = np.sqrt(w*w + x*x + y*y + z*z)\\n    if norm < 1e-6: # 避免除以零\\n        w = 1.0\\n        x = 0.0\\n        y = 0.0\\n        z = 0.0\\n    else:\\n        w /= norm\\n        x /= norm\\n        y /= norm\\n        z /= norm\\n\\n    # 然后构建旋转矩阵\\n    xx = x * x\\n    xy = x * y\\n    xz = x * z\\n    xw = x * w\\n\\n    yy = y * y\\n    yz = y * z\\n    yw = y * w\\n\\n    zz = z * z\\n    zw = z * w\\n\\n    rotation_matrix = np.array([\\n        [1 - 2 * (yy + zz), 2 * (xy - zw), 2 * (xz + yw)],\\n        [2 * (xy + zw), 1 - 2 * (xx + zz), 2 * (yz - xw)],\\n        [2 * (xz - yw), 2 * (yz + xw), 1 - 2 * (xx + yy)]\\n    ])\\n\\n    return rotation_matrix\\n\\n\\ndef quaternion_norm(quaternion):\\n    \\\"\\\"\\\"计算四元数的范数.\\\"\\\"\\\"\\n    return np.sqrt(np.sum(quaternion * quaternion))\\n\\n\\ndef quaternion_normalize(quaternion):\\n    \\\"\\\"\\\"归一化四元数，处理可能的除零情况.\\n    使用范数避免可能的除零错误.\\n    \\\"\\\"\\\"\\n    norm = quaternion_norm(quaternion)\\n    if norm < 1e-8:\\n        return np.array([1.0, 0.0, 0.0, 0.0])  # 返回单位四元数\\n    return quaternion / norm\\n\"\n  }\n]",
  "model": "gemini-2.0-flash"
}